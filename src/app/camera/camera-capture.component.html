<div class="camera-page">
  <h1 class="title">Capture clothing item</h1>

  <p class="hint">
    Place the item on a plain background, fill the frame, and make sure the lighting is even.
  </p>

  <div class="camera-frame" [class.camera-frame--inactive]="!isCameraActive && !hasCaptured">
    @if (isCameraActive && !hasCaptured) {
      <video
        #video
        class="camera-video"
        autoplay
        playsinline
        muted
      ></video>
    }

    <canvas #canvas class="camera-canvas" hidden></canvas>

    @if (hasCaptured && capturedDataUrl) {
      <img
        [src]="capturedDataUrl"
        alt="Captured item preview"
        class="camera-preview"
      />
    }

    @if (!isCameraActive && !hasCaptured) {
      <div class="camera-placeholder">
        <span>Camera is off. Tap "Start camera" to begin.</span>
      </div>
    }
  </div>

  @if (errorMessage) {
    <div class="error">
      {{ errorMessage }}
    </div>
  }

  <div class="controls">
    @if (!isCameraActive && !hasCaptured) {
      <button
        type="button"
        class="btn primary"
        (click)="startCamera()"
      >
        Start camera
      </button>
    }

    @if (isCameraActive && !hasCaptured) {
      <button
        type="button"
        class="btn primary"
        (click)="capturePhoto()"
      >
        Capture
      </button>
    }

    @if (isCameraActive) {
      <button
        type="button"
        class="btn secondary"
        (click)="stopCamera()"
      >
        Stop camera
      </button>
    }

    @if (hasCaptured) {
      <button
        type="button"
        class="btn secondary"
        (click)="retake()"
      >
        Retake
      </button>
    }

    @if (hasCaptured) {
      <button
        type="button"
        class="btn success"
        (click)="usePhoto()"
      >
        Use this photo
      </button>
    }
  </div>
</div>
